<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>STM32F4DISCOVERY-TEST: D:/Project_Keil/STM32F4DISCOVERY/Src/main.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>D:/Project_Keil/STM32F4DISCOVERY/Src/main.c File Reference</h1>: Main program body  
<a href="#_details">More...</a>
<p>
<code>#include &quot;main.h&quot;</code><br>
<code>#include &quot;adc.h&quot;</code><br>
<code>#include &quot;dma.h&quot;</code><br>
<code>#include &quot;usb_device.h&quot;</code><br>
<code>#include &quot;usbd_cdc_if.h&quot;</code><br>
<code>#include &quot;gpio.h&quot;</code><br>
<code>#include &quot;dac.h&quot;</code><br>
<code>#include &lt;stdio.h&gt;</code><br>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f6510ec9c01be68b14a02327ef5889e1"></a><!-- doxytag: member="main.c::ADC_RANGE" ref="f6510ec9c01be68b14a02327ef5889e1" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#f6510ec9c01be68b14a02327ef5889e1">ADC_RANGE</a>&nbsp;&nbsp;&nbsp;4096.0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Range of digital ADC values. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5a03d0b939a8dda552c9fe3319a82485"></a><!-- doxytag: member="main.c::ADC_VREF" ref="5a03d0b939a8dda552c9fe3319a82485" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#5a03d0b939a8dda552c9fe3319a82485">ADC_VREF</a>&nbsp;&nbsp;&nbsp;3.0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Vref+ ADC. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a447c2e4e00b68e272d6a74a70e0cf3f"></a><!-- doxytag: member="main.c::SIZE_ARRAY_USB" ref="a447c2e4e00b68e272d6a74a70e0cf3f" args="" -->
#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#a447c2e4e00b68e272d6a74a70e0cf3f">SIZE_ARRAY_USB</a>&nbsp;&nbsp;&nbsp;8</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The size of the array to transfer to USB. <br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#70af21c671abfcc773614a9a4f63d920">SystemClock_Config</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">System Clock Configuration.  <a href="#70af21c671abfcc773614a9a4f63d920"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#2e03a7c8934f1b3566ba62d0adc5a5e6">ConversionDigitalToArray</a> (float input, uint8_t *pArray)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The function is designed to convert digital values into an array of type char.  <a href="#2e03a7c8934f1b3566ba62d0adc5a5e6"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">char&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#e172614e324932599305661b8d8d5ac5">ConversionIntegerToChar</a> (uint32_t integer_input)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The function is intended to convert an integer number to a character.  <a href="#e172614e324932599305661b8d8d5ac5"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The application entry point.  <a href="#840291bc02cba5474a4cb46a9b9566fe"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#1730ffe1e560465665eb47d9264826f9">Error_Handler</a> (void)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This function is executed in case of error occurrence.  <a href="#1730ffe1e560465665eb47d9264826f9"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b3803d0dcc07c34a2bdc1733b04e8b91"></a><!-- doxytag: member="main.c::ui8FlagIntSysTick" ref="b3803d0dcc07c34a2bdc1733b04e8b91" args="" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#b3803d0dcc07c34a2bdc1733b04e8b91">ui8FlagIntSysTick</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flag interrupt SysTick. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="81d1111371aaec05825de523157c36cd"></a><!-- doxytag: member="main.c::ui32ResultConversionADC" ref="81d1111371aaec05825de523157c36cd" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#81d1111371aaec05825de523157c36cd">ui32ResultConversionADC</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ADC conversion result. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c53c787d427e436a068558dfc2282597"></a><!-- doxytag: member="main.c::ui16Result" ref="c53c787d427e436a068558dfc2282597" args="" -->
uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#c53c787d427e436a068558dfc2282597">ui16Result</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">ADC conversion result after masking. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="eb4ff8e07125d50d779ba135975ac2a3"></a><!-- doxytag: member="main.c::f32Voltage_V" ref="eb4ff8e07125d50d779ba135975ac2a3" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#eb4ff8e07125d50d779ba135975ac2a3">f32Voltage_V</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Value in V. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="5c00d82782fd1d10bf0e4469075a635b"></a><!-- doxytag: member="main.c::f32Voltage_mV" ref="5c00d82782fd1d10bf0e4469075a635b" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#5c00d82782fd1d10bf0e4469075a635b">f32Voltage_mV</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Value in mV. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0d6779398f57caab7d191b220bed7ff5"></a><!-- doxytag: member="main.c::f32VoltageAverage" ref="0d6779398f57caab7d191b220bed7ff5" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#0d6779398f57caab7d191b220bed7ff5">f32VoltageAverage</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Averaging the result in 1 second. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="b4a3997930a2568b16f0ead80d802bf9"></a><!-- doxytag: member="main.c::f32TempVoltageAverage" ref="b4a3997930a2568b16f0ead80d802bf9" args="" -->
float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#b4a3997930a2568b16f0ead80d802bf9">f32TempVoltageAverage</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Accumulation. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ad67f8527f1b7a89a212d6217d6812a6"></a><!-- doxytag: member="main.c::ui32CounterVoltageAverage" ref="ad67f8527f1b7a89a212d6217d6812a6" args="" -->
uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#ad67f8527f1b7a89a212d6217d6812a6">ui32CounterVoltageAverage</a> = 0</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Counter for 1 sec. <br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="98e2efe3feb9ffd999ec0a69b66b0496"></a><!-- doxytag: member="main.c::ui8TxArrayUSB" ref="98e2efe3feb9ffd999ec0a69b66b0496" args="[SIZE_ARRAY_USB]" -->
uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="main_8c.html#98e2efe3feb9ffd999ec0a69b66b0496">ui8TxArrayUSB</a> [SIZE_ARRAY_USB]</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Data array for transmission over USB. <br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
: Main program body 
<p>
This notice applies to any and all portions of this file that are not between comment pairs USER CODE BEGIN and USER CODE END. Other portions of this file, whether inserted by the user or by software development tools are owned by their respective copyright owners.<p>
Copyright (c) 2019 STMicroelectronics International N.V. All rights reserved.<p>
Redistribution and use in source and binary forms, with or without modification, are permitted, provided that the following conditions are met:<p>
1. Redistribution of source code must retain the above copyright notice, this list of conditions and the following disclaimer. 2. Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution. 3. Neither the name of STMicroelectronics nor the names of other contributors to this software may be used to endorse or promote products derived from this software without specific written permission. 4. This software, including modifications and/or derivative works of this software, must execute solely and exclusively on microcontroller or microprocessor devices manufactured by or for STMicroelectronics. 5. Redistribution and use of this software other than as permitted under this license is void and will automatically terminate your rights under this license. <hr><h2>Function Documentation</h2>
<a class="anchor" name="2e03a7c8934f1b3566ba62d0adc5a5e6"></a><!-- doxytag: member="main.c::ConversionDigitalToArray" ref="2e03a7c8934f1b3566ba62d0adc5a5e6" args="(float input, uint8_t *pArray)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ConversionDigitalToArray           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&nbsp;</td>
          <td class="paramname"> <em>pArray</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The function is designed to convert digital values into an array of type char. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>input</em>&nbsp;</td><td>- Float value. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pArray</em>&nbsp;</td><td>- Pointer to array char type. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>None.</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="e172614e324932599305661b8d8d5ac5"></a><!-- doxytag: member="main.c::ConversionIntegerToChar" ref="e172614e324932599305661b8d8d5ac5" args="(uint32_t integer_input)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char ConversionIntegerToChar           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>integer_input</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The function is intended to convert an integer number to a character. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>integer_input</em>&nbsp;</td><td>- Integer value. </td></tr>
  </table>
</dl>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>result</em>&nbsp;</td><td>- ASCII character. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="1730ffe1e560465665eb47d9264826f9"></a><!-- doxytag: member="main.c::Error_Handler" ref="1730ffe1e560465665eb47d9264826f9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Error_Handler           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is executed in case of error occurrence. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>None</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="840291bc02cba5474a4cb46a9b9566fe"></a><!-- doxytag: member="main.c::main" ref="840291bc02cba5474a4cb46a9b9566fe" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
The application entry point. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

<p>
Algorithm of the main program Check setting the flag every 1 ms<p>
Clear flag interrupt SysTick<p>
Start ADC conversion and flow DMA<p>
Result masking<p>
Start DAC<p>
Set value DAC<p>
Error message, if DAC not set value<p>
Calculate real voltage in V<p>
Accumulation result<p>
Averaging counter increment<p>
Check averaging counter If averaging counter &gt;= 1000, then<p>
Reset averaging counter<p>
Calculate voltage average value<p>
Conversion from volts to millivolts<p>
Convert voltage to array uint8_t<p>
Data transfer through USB-CDC<p>
Print message to SWD Keil<p>
Error message, if ADC error result 
</div>
</div><p>
<a class="anchor" name="70af21c671abfcc773614a9a4f63d920"></a><!-- doxytag: member="main.c::SystemClock_Config" ref="70af21c671abfcc773614a9a4f63d920" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SystemClock_Config           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
System Clock Configuration. 
<p>
<dl compact><dt><b>Return values:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>None</em>&nbsp;</td><td></td></tr>
  </table>
</dl>

<p>
Configure the main internal regulator output voltage<p>
Initializes the CPU, AHB and APB busses clocks<p>
Initializes the CPU, AHB and APB busses clocks
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sun Jan 13 20:26:17 2019 for STM32F4DISCOVERY-TEST by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
